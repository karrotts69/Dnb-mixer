<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Drum and Bass Mixer</title> <style> body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background-color: #f0f0f0; } button, input { margin: 10px; padding: 8px; } </style> </head> <body> <h1>Drum and Bass Mixer</h1> <p>Upload your song and a D&B loop to mix them!</p> <div> <label>Your Song (MP3):</label><br> <input type="file" id="songInput" accept="audio/mp3" /> </div> <div> <label>Drum and Bass Loop (MP3):</label><br> <input type="file" id="loopInput" accept="audio/mp3" /> </div> <button onclick="mixAudio()">Mix and Play</button> <button onclick="downloadMix()" id="downloadBtn" disabled>Download Mix</button> <audio id="audioPlayer" controls></audio> <p id="status"></p> <script> let audioContext; let mixedBuffer; async function mixAudio() { const songFile = document.getElementById('songInput').files[0]; const loopFile = document.getElementById('loopInput').files[0]; const status = document.getElementById('status'); if (!songFile || !loopFile) { status.textContent = "Please upload both files!"; return; } status.textContent = "Processing..."; // Initialize AudioContext audioContext = new (window.AudioContext || window.webkitAudioContext)(); try { // Load and decode audio files const songBuffer = await loadAudioFile(songFile); const loopBuffer = await loadAudioFile(loopFile); // Create offline context for mixing const offlineContext = new OfflineAudioContext( 2, // Stereo songBuffer.length, songBuffer.sampleRate ); // Create source nodes const songSource = offlineContext.createBufferSource(); const loopSource = offlineContext.createBufferSource(); songSource.buffer = songBuffer; loopSource.buffer = loopBuffer; // Create gain nodes for volume control const songGain = offlineContext.createGain(); const loopGain = offlineContext.createGain(); songGain.gain.value = 0.7; // ~ -5dB loopGain.gain.value = 0.3; // ~ -10dB // Connect nodes songSource.connect(songGain).connect(offlineContext.destination); loopSource.connect(loopGain).connect(offlineContext.destination); // Loop the drum and bass track loopSource.loop = true; // Start both sources songSource.start(0); loopSource.start(0); // Render the mix mixedBuffer = await offlineContext.startRendering(); // Play the result const audioPlayer = document.getElementById('audioPlayer'); const blob = await bufferToWave(mixedBuffer); audioPlayer.src = URL.createObjectURL(blob); audioPlayer.play(); status.textContent = "Mix complete! Click 'Download Mix' to save."; document.getElementById('downloadBtn').disabled = false; } catch (error) { status.textContent = `Error: ${error.message}`; } } async function loadAudioFile(file) { const arrayBuffer = await file.arrayBuffer(); return await audioContext.decodeAudioData(arrayBuffer); } // Convert AudioBuffer to WAV (browsers don't export MP3 natively) async function bufferToWave(buffer) { const numOfChan = buffer.numberOfChannels; const length = buffer.length * numOfChan * 2 + 44; const arrayBuffer = new ArrayBuffer(length); const view = new DataView(arrayBuffer); // WAV header writeString(view, 0, 'RIFF'); view.setUint32(4, 36 + buffer.length * numOfChan * 2, true); writeString(view, 8, 'WAVE'); writeString(view, 12, 'fmt '); view.setUint32(16, 16, true); view.setUint16(20, 1, true); view.setUint16(22, numOfChan, true); view.setUint32(24, buffer.sampleRate, true); view.setUint32(28, buffer.sampleRate * numOfChan * 2, true); view.setUint16(32, numOfChan * 2, true); view.setUint16(34, 16, true); writeString(view, 36, 'data'); view.setUint32(40, buffer.length * numOfChan * 2, true); // Write PCM data let offset = 44; for (let i = 0; i < buffer.length; i++) { for (let channel = 0; channel < numOfChan; channel++) { const sample = Math.max(-1, Math.min(1, buffer.getChannelData(channel)[i])); view.setInt16(offset, sample * 0x7FFF, true); offset += 2; } } return new Blob([arrayBuffer], { type: 'audio/wav' }); } function writeString(view, offset, string) { for (let i = 0; i < string.length; i++) { view.setUint8(offset + i, string.charCodeAt(i)); } } function downloadMix() { if (!mixedBuffer) return; bufferToWave(mixedBuffer).then(blob => { const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'mixed_audio.wav'; document.body.appendChild(a); a.click(); document.body.removeChild(a); }); } </script> </body> </html> 